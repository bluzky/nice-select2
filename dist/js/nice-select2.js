!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.NiceSelect=t():e.NiceSelect=t()}(self,()=>(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{bind:()=>u,default:()=>p});const s=(e,t,s={})=>{let i;i="click"===t?MouseEvent:"change"===t?Event:t.includes("focus")?FocusEvent:UIEvent;const l=new i(t,{bubbles:!0,cancelable:!1,...s});e.dispatchEvent(l)},i=e=>s(e,"click"),l=e=>s(e,"change"),n=e=>s(e,"modalclose"),o=(e,t)=>void 0!==e[t]?e[t]:e.getAttribute(t),d=(e,t)=>e?.classList.contains(t),r=(e,t)=>e?.classList.add(t),a=(e,t)=>e?.classList.remove(t),c={data:null,searchable:!0,showSelectedItems:!0,placeholder:"Select an option",searchtext:"Search",selectedtext:"selected",hideSelect:!0};class h{constructor(e,t={}){if(!e)throw new Error("No element provided to NiceSelect");if(!(e instanceof Element))throw new Error("Invalid element provided to NiceSelect - must be a valid DOM element");this.el=e,this.el._niceSelect=this,this.config={...c,...t},this.data=this.config.data,this.selectedOptions=[],this.placeholder=o(this.el,"placeholder")||this.config.placeholder,this.searchtext=o(this.el,"searchtext")||this.config.searchtext,this.selectedtext=o(this.el,"selectedtext")||this.config.selectedtext,this.dropdown=null,this.selectionList=null,this.multiple=o(this.el,"multiple"),this.disabled=o(this.el,"disabled"),this.create(),this.bindElementEvents()}create(e=!0){this.data?this.processData(this.data):this.extractData(e),this.el.classList.remove("hidden-select"),this.renderDropdown(),this.config.hideSelect&&this.el.classList.add("hidden-select"),this.bindDropdownEvents()}processData(e){this.options=e.map(e=>({data:e,attributes:{selected:!!e.selected,disabled:!!e.disabled,optgroup:"optgroup"===e.value}}))}extractData(e){const t=Array.from(this.el.querySelectorAll("option,optgroup")),s=[],i=[];this.data=t.map(t=>{let l,n=t.selected;e&&t.selected&&!t.defaultSelected&&(n=!1),l="OPTGROUP"===t.tagName?{text:t.label,value:"optgroup"}:{text:t.dataset.display??t.innerText,value:t.value,extra:t.dataset.extra,selected:n,disabled:t.disabled};const o={selected:n,disabled:t.disabled,optgroup:"OPTGROUP"===t.tagName},d={data:l,attributes:o,element:null};return s.push(d),o.selected&&i.push(d),l}),this.options=s,this.selectedOptions=i}renderDropdown(){const e=["nice-select",o(this.el,"class")||"",this.disabled?"disabled":"",this.multiple?"has-multiple":""].filter(Boolean),t=this.config.searchable?`\n      <div class="nice-select-search-box">\n        <input type="text" class="nice-select-search" placeholder="${this.searchtext}..." title="search"/>\n      </div>\n    `:"",s=`\n      <div class="${e.join(" ")}" tabindex="${this.disabled?"":0}">\n        <span class="${this.multiple?"multiple-options":"current"}"></span>\n        <div class="nice-select-dropdown">\n          ${t}\n          <ul class="list"></ul>\n        </div>\n      </div>\n    `;this.el.insertAdjacentHTML("afterend",s),this.dropdown=this.el.nextElementSibling,this._renderSelectedItems(),this._renderItems()}_renderSelectedItems(){if(this.multiple){let e="";"auto"===window.getComputedStyle(this.dropdown).width||this.selectedOptions.length<2?(this.selectedOptions.forEach((t,s,i)=>{let l=t.data.text;s!==i.length-1&&(l+=", "),e+=`<span class="current">${l}</span>`}),e=e||this.placeholder):e=`${this.selectedOptions.length} ${this.selectedtext}`,this.dropdown.querySelector(".multiple-options").innerHTML=e}else{const e=this.selectedOptions.length>0?this.selectedOptions[0].data.text:this.placeholder;this.dropdown.querySelector(".current").innerHTML=e}}_renderItems(){const e=this.dropdown.querySelector("ul");this.options.forEach(t=>{this.multiple&&this.config.showSelectedItems&&this._multipleListAdd(t),e.appendChild(this._renderItem(t))})}_renderItem(e){const t=document.createElement("li");if(t.innerHTML=e.data.text,void 0!==e.data.extra&&t.appendChild(this._renderItemExtra(e.data.extra)),e.attributes.optgroup)r(t,"optgroup");else{t.setAttribute("data-value",e.data.value);const s=["option"];e.attributes.selected&&s.push("selected"),e.attributes.disabled&&s.push("disabled"),t.classList.add(...s),t.addEventListener("click",t=>this._onDropdownItemClicked(e,t))}return e.element=t,t}_renderItemExtra(e){const t=document.createElement("span");return t.innerHTML=e,r(t,"extra"),t}update(e=""){let t=this;""!=e&&(t=e.target._niceSelect),t.syncDropdown()}disable(){this.disabled||(this.disabled=!0,r(this.dropdown,"disabled"))}enable(){this.disabled&&(this.disabled=!1,a(this.dropdown,"disabled"))}clear(){this.resetSelectValue(),this.selectedOptions=[],this._renderSelectedItems(),this.update(),l(this.el)}destroy(){this.selectionList&&this.removeSelectionList(),this.dropdown&&(this.dropdown.remove(),this.el.classList.remove("hidden-select"))}focus(e=""){var t;if(d(this.dropdown,"open")?this.multiple?e===this.dropdown.querySelector(".multiple-options")&&(a(this.dropdown,"open"),n(this.el)):(a(this.dropdown,"open"),n(this.el)):(r(this.dropdown,"open"),t=this.el,s(t,"modalopen")),d(this.dropdown,"open")){const e=this.dropdown.querySelector(".nice-select-search");e&&(e.value="",e.focus());const t=this.dropdown.querySelector(".focus");t&&a(t,"focus");const s=this.dropdown.querySelector(".selected");s&&r(s,"focus"),this.dropdown.querySelectorAll("ul li").forEach(e=>e.style.display="")}else this.dropdown.focus()}bindElementEvents(){this.el.addEventListener("invalid",()=>this._triggerValidationMessage("invalid")),window.addEventListener("click",e=>this._onClickedOutside(e)),this.el.addEventListener("change",this.update)}bindDropdownEvents(){this.dropdown.addEventListener("click",e=>this._onClicked(e)),this.dropdown.addEventListener("keydown",e=>this._onKeyPressed(e)),this.dropdown.addEventListener("focusin",()=>{return e=this.el,s(e,"focusin");var e}),this.dropdown.addEventListener("focusout",()=>{return e=this.el,s(e,"focusout");var e}),this.config.searchable&&this._bindSearchEvent()}_bindSearchEvent(){const e=this.dropdown.querySelector(".nice-select-search");e&&(e.addEventListener("click",e=>e.stopPropagation()),e.addEventListener("input",e=>this._onSearchChanged(e)))}_onClicked(e){e.preventDefault(),this.focus(e.target)}_onDropdownItemClicked(e,t){const s=t.target;if(!d(s,"disabled")){if(this.multiple){let t;d(s,"selected")?(t=!1,a(s,"selected"),this.selectedOptions=this.selectedOptions.filter(t=>t.data!==e.data)):(t=!0,r(s,"selected"),this.selectedOptions.push(e)),e.data.selected=t,e.attributes.selected=t}else{this.dropdown.querySelectorAll("li.selected").forEach(e=>a(e,"selected")),r(s,"selected"),this.selectedOptions=[e];let t=this.options.find(e=>e.attributes.selected);t&&(t.data.selected=!1,t.attributes.selected=!1),e.data.selected=!0,e.attributes.selected=!0}this._renderSelectedItems(),this.syncSelectValue(),this.syncSelectionList()}}syncSelectValue(){const e=this.el;this.selectedOptions.length>0?e.value=this.selectedOptions[0].data.value:(e.value="",e.selectedIndex=-1),this.options.forEach(t=>{let s=Array.from(e.options).find(e=>e.textContent===t.data.text);null==s&&(s=Array.from(e.options).find(e=>e.textContent===t.data.value)),t.attributes.selected?s.selected=!0:s.selected=!1}),e.removeEventListener("change",this.update),l(e),e.addEventListener("change",this.update)}resetSelectValue(){if(this.multiple){const e=this.el;this.selectedOptions.forEach(t=>{const s=e.querySelector(`option[value="${t.data.value}"]`);s&&(s.selected=!1)})}else this.selectedOptions.length>0&&(this.el.selectedIndex=-1);l(this.el)}syncDropdown(){if(this.dropdown){const e=d(this.dropdown,"open");this.removeSelectionList(),this.dropdown.remove(),this.data=null,this.create(!1),e&&i(this.dropdown)}o(this.el,"disabled")?this.disable():this.enable()}syncSelectionList(){this.config.showSelectedItems&&(this.removeSelectionList(),this.selectedOptions.forEach(e=>{this._multipleListAdd(e)}))}_onClickedOutside(e){this.dropdown.contains(e.target)||(a(this.dropdown,"open"),n(this.el))}_onKeyPressed(e){const t=this.dropdown.querySelector(".focus"),s=d(this.dropdown,"open");if(13===e.keyCode)i(s?t:this.dropdown);else if(40===e.keyCode){if(s){const e=this._findNext(t);e&&(t&&a(t,"focus"),r(e,"focus"))}else i(this.dropdown);e.preventDefault()}else if(38===e.keyCode){if(s){const e=this._findPrev(t);e&&(t&&a(t,"focus"),r(e,"focus"))}else i(this.dropdown);e.preventDefault()}else if(27===e.keyCode&&s)i(this.dropdown);else if(32===e.keyCode&&s)return!1;const l=this.dropdown.querySelector(".focus");return l&&l.scrollIntoView({block:"center"}),!1}_findNext(e){let t=e?e.nextElementSibling:this.dropdown.querySelector(".list .option");for(;t;){if(!d(t,"disabled")&&"none"!==t.style.display)return t;t=t.nextElementSibling}return null}_findPrev(e){let t=e?e.previousElementSibling:this.dropdown.querySelector(".list .option:last-child");for(;t;){if(!d(t,"disabled")&&"none"!==t.style.display)return t;t=t.previousElementSibling}return null}_onSearchChanged(e){const t=e.target.value.toLowerCase();if(""===t)this.options.forEach(e=>e.element.style.display="");else if(d(this.dropdown,"open")){const e=new RegExp(t);this.options.forEach(t=>{t.element.style.display=e.test(t.data.text.toLowerCase())?"":"none"})}this.dropdown.querySelectorAll(".focus").forEach(e=>a(e,"focus"));const s=this._findNext(null);s&&r(s,"focus")}_triggerValidationMessage(e){"invalid"===e?(r(this.dropdown,"invalid"),a(this.dropdown,"valid")):(r(this.dropdown,"valid"),a(this.dropdown,"invalid"))}removeSelectionList(){null!=this.selectionList&&(this.selectionList.remove(),this.selectionList=null)}updateDropdownOption(){}_multipleListAdd(e){if(!this.multiple||e.data.disabled||""==e.data.value||!e.attributes.selected)return;if(null==this.selectionList)this.selectionList=document.createElement("ul"),this.selectionList.classList.add("select-selection-list"),this.el.after(this.selectionList);else if(null!=this.selectionList.querySelector(`[data-value="${e.data.value}"]`))return;let t=document.createElement("li");t.classList.add("select-selection"),t.dataset.value=e.data.value;let s='\n      <button type="button" class="small remove-select-selection">\n        <span class=\'remove-select-selection\'>×</span>\n      </button>\n    ';s+=`<span class='selected-name'>${e.data.text}</span>`,t.innerHTML=s,this.selectionList.appendChild(t),t.querySelectorAll(".remove-select-selection").forEach(e=>e.addEventListener("click",this._multipleListRemove.bind(this)))}_multipleListRemove(e){if(null==this.selectionList)return;if(null!=e.target&&(e=e.target),null==e.matches||!e.matches(".remove-select-selection"))return;let t=e.closest("li.select-selection"),s=this.options.find(e=>e.data.value===t.dataset.value).element;s&&s.matches(".selected")&&s.click()}}const p=h;function u(e,t){return new h(e,t)}return t})());
//# sourceMappingURL=nice-select2.js.map