!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.NiceSelect=t():e.NiceSelect=t()}(self,(()=>(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{bind:()=>u,default:()=>p});const s=(e,t,s={})=>{let i;i="click"===t?MouseEvent:"change"===t?Event:t.includes("focus")?FocusEvent:UIEvent;const o=new i(t,{bubbles:!0,cancelable:!1,...s});e.dispatchEvent(o)},i=e=>s(e,"click"),o=e=>s(e,"change"),l=e=>s(e,"modalclose"),d=(e,t)=>void 0!==e[t]?e[t]:e.getAttribute(t),n=(e,t)=>e?.classList.contains(t),r=(e,t)=>e?.classList.add(t),a=(e,t)=>e?.classList.remove(t),c={data:null,searchable:!1,showSelectedItems:!1,placeholder:"Select an option",searchtext:"Search",selectedtext:"selected"};class h{constructor(e,t={}){this.el=e,this.config={...c,...t},this.data=this.config.data,this.selectedOptions=[],this.placeholder=d(this.el,"placeholder")||this.config.placeholder,this.searchtext=d(this.el,"searchtext")||this.config.searchtext,this.selectedtext=d(this.el,"selectedtext")||this.config.selectedtext,this.dropdown=null,this.multiple=d(this.el,"multiple"),this.disabled=d(this.el,"disabled"),this.create()}create(){Object.assign(this.el.style,{opacity:"0",width:"0",padding:"0",height:"0",fontSize:"0"}),this.data?this.processData(this.data):this.extractData(),this.renderDropdown(),this.bindEvent()}processData(e){this.options=e.map((e=>({data:e,attributes:{selected:!!e.selected,disabled:!!e.disabled,optgroup:"optgroup"===e.value}})))}extractData(){const e=Array.from(this.el.querySelectorAll("option,optgroup")),t=[],s=[];this.data=e.map((e=>{let i;i="OPTGROUP"===e.tagName?{text:e.label,value:"optgroup"}:{text:e.dataset.display??e.innerText,value:e.value,extra:e.dataset.extra,selected:e.hasAttribute("selected"),disabled:e.hasAttribute("disabled")};const o={selected:e.hasAttribute("selected"),disabled:e.hasAttribute("disabled"),optgroup:"OPTGROUP"===e.tagName},l={data:i,attributes:o,element:null};return t.push(l),o.selected&&s.push(l),i})),this.options=t,this.selectedOptions=s}renderDropdown(){const e=["nice-select",d(this.el,"class")||"",this.disabled?"disabled":"",this.multiple?"has-multiple":""].filter(Boolean),t=this.config.searchable?`\n      <div class="nice-select-search-box">\n        <input type="text" class="nice-select-search" placeholder="${this.searchtext}..." title="search"/>\n      </div>\n    `:"",s=`\n      <div class="${e.join(" ")}" tabindex="${this.disabled?"":0}">\n        <span class="${this.multiple?"multiple-options":"current"}"></span>\n        <div class="nice-select-dropdown">\n          ${t}\n          <ul class="list"></ul>\n        </div>\n      </div>\n    `;this.el.insertAdjacentHTML("afterend",s),this.dropdown=this.el.nextElementSibling,this._renderSelectedItems(),this._renderItems()}_renderSelectedItems(){if(this.multiple){let e="";this.config.showSelectedItems||"auto"===window.getComputedStyle(this.dropdown).width||this.selectedOptions.length<2?(this.selectedOptions.forEach((t=>{e+=`<span class="current">${t.data.text}</span>`})),e=e||this.placeholder):e=`${this.selectedOptions.length} ${this.selectedtext}`,this.dropdown.querySelector(".multiple-options").innerHTML=e}else{const e=this.selectedOptions.length>0?this.selectedOptions[0].data.text:this.placeholder;this.dropdown.querySelector(".current").innerHTML=e}}_renderItems(){const e=this.dropdown.querySelector("ul");this.options.forEach((t=>e.appendChild(this._renderItem(t))))}_renderItem(e){const t=document.createElement("li");if(t.innerHTML=e.data.text,void 0!==e.data.extra&&t.appendChild(this._renderItemExtra(e.data.extra)),e.attributes.optgroup)r(t,"optgroup");else{t.setAttribute("data-value",e.data.value);const s=["option"];e.attributes.selected&&s.push("selected"),e.attributes.disabled&&s.push("disabled"),t.classList.add(...s),t.addEventListener("click",(t=>this._onItemClicked(e,t)))}return e.element=t,t}_renderItemExtra(e){const t=document.createElement("span");return t.innerHTML=e,r(t,"extra"),t}update(){if(this.extractData(),this.dropdown){const e=n(this.dropdown,"open");this.dropdown.remove(),this.create(),e&&i(this.dropdown)}d(this.el,"disabled")?this.disable():this.enable()}disable(){this.disabled||(this.disabled=!0,r(this.dropdown,"disabled"))}enable(){this.disabled&&(this.disabled=!1,a(this.dropdown,"disabled"))}clear(){this.resetSelectValue(),this.selectedOptions=[],this._renderSelectedItems(),this.update(),o(this.el)}destroy(){this.dropdown&&(this.dropdown.remove(),this.el.style.display="")}bindEvent(){this.dropdown.addEventListener("click",(e=>this._onClicked(e))),this.dropdown.addEventListener("keydown",(e=>this._onKeyPressed(e))),this.dropdown.addEventListener("focusin",(()=>{return e=this.el,s(e,"focusin");var e})),this.dropdown.addEventListener("focusout",(()=>{return e=this.el,s(e,"focusout");var e})),this.el.addEventListener("invalid",(()=>this._triggerValidationMessage("invalid"))),window.addEventListener("click",(e=>this._onClickedOutside(e))),this.config.searchable&&this._bindSearchEvent()}_bindSearchEvent(){const e=this.dropdown.querySelector(".nice-select-search");e&&(e.addEventListener("click",(e=>e.stopPropagation())),e.addEventListener("input",(e=>this._onSearchChanged(e))))}_onClicked(e){var t;if(e.preventDefault(),n(this.dropdown,"open")?this.multiple?e.target===this.dropdown.querySelector(".multiple-options")&&(a(this.dropdown,"open"),l(this.el)):(a(this.dropdown,"open"),l(this.el)):(r(this.dropdown,"open"),t=this.el,s(t,"modalopen")),n(this.dropdown,"open")){const e=this.dropdown.querySelector(".nice-select-search");e&&(e.value="",e.focus());const t=this.dropdown.querySelector(".focus");t&&a(t,"focus");const s=this.dropdown.querySelector(".selected");s&&r(s,"focus"),this.dropdown.querySelectorAll("ul li").forEach((e=>e.style.display=""))}else this.dropdown.focus()}_onItemClicked(e,t){const s=t.target;if(!n(s,"disabled")){if(this.multiple)if(n(s,"selected")){a(s,"selected"),this.selectedOptions=this.selectedOptions.filter((t=>t!==e));const t=this.el.querySelector(`option[value="${s.dataset.value}"]`);t&&(t.removeAttribute("selected"),t.selected=!1)}else r(s,"selected"),this.selectedOptions.push(e);else this.options.forEach((e=>a(e.element,"selected"))),r(s,"selected"),this.selectedOptions=[e];this._renderSelectedItems(),this.updateSelectValue()}}setValue(e){const t=this.el;let s=!0;t.multiple&&(e=e.map(String));for(const i of t.options){const o=t.multiple?e.includes(i.value)?i.value:null:e;i.value!==o||i.disabled?(i.removeAttribute("selected"),i.selected=!1):(s&&(t.value=o,s=!1),i.setAttribute("selected",!0),i.selected=!0)}s&&!t.multiple&&t.options.length&&(t.options[0].setAttribute("selected",!0),t.options[0].selected=!0,t.value=t.options[0].value),this.update()}getValue(){const e=this.el;return e.multiple?Array.from(e.options).filter((e=>e.selected)).map((e=>e.value)):e.value}updateSelectValue(){if(this.multiple){const e=this.el;this.selectedOptions.forEach((t=>{const s=e.querySelector(`option[value="${t.data.value}"]`);s?s.setAttribute("selected",!0):console.error("Option not found, does it have a value?")}))}else this.selectedOptions.length>0&&(this.el.value=this.selectedOptions[0].data.value);o(this.el)}resetSelectValue(){if(this.multiple){const e=this.el;this.selectedOptions.forEach((t=>{const s=e.querySelector(`option[value="${t.data.value}"]`);s&&(s.removeAttribute("selected"),s.selected=!1)}))}else this.selectedOptions.length>0&&(this.el.selectedIndex=-1);o(this.el)}_onClickedOutside(e){this.dropdown.contains(e.target)||(a(this.dropdown,"open"),l(this.el))}_onKeyPressed(e){const t=this.dropdown.querySelector(".focus"),s=n(this.dropdown,"open");if(13===e.keyCode)i(s?t:this.dropdown);else if(40===e.keyCode){if(s){const e=this._findNext(t);e&&(t&&a(t,"focus"),r(e,"focus"))}else i(this.dropdown);e.preventDefault()}else if(38===e.keyCode){if(s){const e=this._findPrev(t);e&&(t&&a(t,"focus"),r(e,"focus"))}else i(this.dropdown);e.preventDefault()}else if(27===e.keyCode&&s)i(this.dropdown);else if(32===e.keyCode&&s)return!1;return!1}_findNext(e){let t=e?e.nextElementSibling:this.dropdown.querySelector(".list .option");for(;t;){if(!n(t,"disabled")&&"none"!==t.style.display)return t;t=t.nextElementSibling}return null}_findPrev(e){let t=e?e.previousElementSibling:this.dropdown.querySelector(".list .option:last-child");for(;t;){if(!n(t,"disabled")&&"none"!==t.style.display)return t;t=t.previousElementSibling}return null}_onSearchChanged(e){const t=e.target.value.toLowerCase();if(""===t)this.options.forEach((e=>e.element.style.display=""));else if(n(this.dropdown,"open")){const e=new RegExp(t);this.options.forEach((t=>{t.element.style.display=e.test(t.data.text.toLowerCase())?"":"none"}))}this.dropdown.querySelectorAll(".focus").forEach((e=>a(e,"focus")));const s=this._findNext(null);s&&r(s,"focus")}_triggerValidationMessage(e){"invalid"===e?(r(this.dropdown,"invalid"),a(this.dropdown,"valid")):(r(this.dropdown,"valid"),a(this.dropdown,"invalid"))}}const p=h;function u(e,t){return new h(e,t)}return t})()));