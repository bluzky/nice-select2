!function(l,c){"object"==typeof exports&&"object"==typeof module?module.exports=c():"function"==typeof define&&define.amd?define([],c):"object"==typeof exports?exports.NiceSelect=c():l.NiceSelect=c()}(self,()=>(()=>{"use strict";var __webpack_modules__={462:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bind: () => (/* binding */ bind),\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n\r\n\r\nconst triggerEvent      = (el, type, init = {}) => {\r\n  let EventConstructor;\r\n  if (type === "click") {\r\n    EventConstructor = MouseEvent;\r\n  } else if (type === "change") {\r\n    EventConstructor = Event;\r\n  } else if (type.includes("focus")) {\r\n    EventConstructor = FocusEvent;\r\n  } else {\r\n    EventConstructor = UIEvent;\r\n  }\r\n  const event = new EventConstructor(type, {\r\n    bubbles: true,\r\n    cancelable: false,\r\n    ...init,\r\n  });\r\n  el.dispatchEvent(event);\r\n};\r\n\r\nconst triggerClick      = (el) => triggerEvent(el, "click");\r\nconst triggerChange     = (el) => triggerEvent(el, "change");\r\nconst triggerFocusIn    = (el) => triggerEvent(el, "focusin");\r\nconst triggerFocusOut   = (el) => triggerEvent(el, "focusout");\r\nconst triggerModalOpen  = (el) => triggerEvent(el, "modalopen");\r\nconst triggerModalClose = (el) => triggerEvent(el, "modalclose");\r\n\r\nconst attr              = (el, key) => el[key] !== undefined ? el[key] : el.getAttribute(key);\r\nconst data              = (el, key) => el.getAttribute("data-" + key);\r\nconst hasClass          = (el, className) => el?.classList.contains(className);\r\nconst addClass          = (el, className) => el?.classList.add(className);\r\nconst removeClass       = (el, className) => el?.classList.remove(className);\r\n\r\nconst defaultOptions = {\r\n  data: null,\r\n  searchable: true,\r\n  showSelectedItems: true,\r\n  placeholder: "Select an option",\r\n  searchtext: "Search",\r\n  selectedtext: "selected",\r\n};\r\n\r\nclass NiceSelect {\r\n  constructor(element, options = {}) {\r\n    if (!element) {\r\n      throw new Error(\'No element provided to NiceSelect\');\r\n    }\r\n\r\n    if (!(element instanceof Element)) {\r\n      throw new Error(\'Invalid element provided to NiceSelect - must be a valid DOM element\');\r\n    }\r\n\r\n    this.el               = element;\r\n    this.config           = { ...defaultOptions, ...options };\r\n    this.data             = this.config.data;\r\n    this.selectedOptions  = [];\r\n    this.placeholder      = attr(this.el, "placeholder") || this.config.placeholder;\r\n    this.searchtext       = attr(this.el, "searchtext") || this.config.searchtext;\r\n    this.selectedtext     = attr(this.el, "selectedtext") || this.config.selectedtext;\r\n    this.dropdown         = null;\r\n    this.selectionList    = null;\r\n    this.multiple         = attr(this.el, "multiple");\r\n    this.disabled         = attr(this.el, "disabled");\r\n    this.create();\r\n  }\r\n\r\n  create() {\r\n    Object.assign(this.el.style, {\r\n      opacity: "0",\r\n      width: "0",\r\n      padding: "0",\r\n      height: "0",\r\n      fontSize: "0",\r\n      minHeight: "auto",\r\n    });\r\n\r\n    this.data ? this.processData(this.data) : this.extractData();\r\n    this.renderDropdown();\r\n    this.bindEvent();\r\n  }\r\n\r\n  processData(data) {\r\n    this.options = data.map((item) => ({\r\n      data: item,\r\n      attributes: {\r\n        selected: !!item.selected,\r\n        disabled: !!item.disabled,\r\n        optgroup: item.value === "optgroup",\r\n      },\r\n    }));\r\n  }\r\n\r\n  extractData() {\r\n    const options = Array.from(this.el.querySelectorAll("option,optgroup"));\r\n    const allOptions = [];\r\n    const selectedOptions = [];\r\n\r\n    this.data = options.map((item) => {\r\n      let itemData;\r\n\r\n      if (item.tagName === "OPTGROUP") {\r\n        itemData = { text: item.label, value: "optgroup" };\r\n      } else {\r\n        const text = item.dataset.display ?? item.innerText;\r\n        itemData = {\r\n          text,\r\n          value: item.value,\r\n          extra: item.dataset.extra,\r\n          selected: item.hasAttribute("selected"),\r\n          disabled: item.hasAttribute("disabled"),\r\n        };\r\n      }\r\n\r\n      const attributes = {\r\n        selected: item.hasAttribute("selected"),\r\n        disabled: item.hasAttribute("disabled"),\r\n        optgroup: item.tagName === "OPTGROUP",\r\n      };\r\n\r\n      const optionObj = { data: itemData, attributes, element: null };\r\n\r\n      allOptions.push(optionObj);\r\n\r\n      if (attributes.selected) selectedOptions.push(optionObj);\r\n\r\n      return itemData;\r\n    });\r\n\r\n    this.options          = allOptions;\r\n    this.selectedOptions  = selectedOptions;\r\n  }\r\n\r\n  renderDropdown() {\r\n    const classes = [\r\n      "nice-select",\r\n      attr(this.el, "class") || "",\r\n      this.disabled ? "disabled" : "",\r\n      this.multiple ? "has-multiple" : "",\r\n    ].filter(Boolean);\r\n\r\n    const searchHtml = this.config.searchable\r\n      ? `\r\n      <div class="nice-select-search-box">\r\n        <input type="text" class="nice-select-search" placeholder="${this.searchtext}..." title="search"/>\r\n      </div>\r\n    `\r\n      : "";\r\n\r\n    const html = `\r\n      <div class="${classes.join(" ")}" tabindex="${this.disabled ? "" : 0}">\r\n        <span class="${this.multiple ? "multiple-options" : "current"}"></span>\r\n        <div class="nice-select-dropdown">\r\n          ${searchHtml}\r\n          <ul class="list"></ul>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    this.el.insertAdjacentHTML("afterend", html);\r\n\r\n    this.dropdown = this.el.nextElementSibling;\r\n\r\n    this._renderSelectedItems();\r\n\r\n    this._renderItems();\r\n  }\r\n\r\n  _renderSelectedItems() {\r\n    if (this.multiple) {\r\n      let selectedHtml = "";\r\n\r\n      if (\r\n        window.getComputedStyle(this.dropdown).width === "auto" ||\r\n        this.selectedOptions.length < 2\r\n      ) {\r\n        this.selectedOptions.forEach( (item, index, array) => {\r\n          let text  = item.data.text;\r\n\r\n          if(index !== array.length -1 ){\r\n            text += `, `;\r\n          }\r\n\r\n          selectedHtml += `<span class="current">${text}</span>`;\r\n        });\r\n\r\n        selectedHtml = selectedHtml || this.placeholder;\r\n      } else {\r\n        selectedHtml = `${this.selectedOptions.length} ${this.selectedtext}`;\r\n      }\r\n\r\n      this.dropdown.querySelector(".multiple-options").innerHTML = selectedHtml;\r\n    } else {\r\n      const html =\r\n        this.selectedOptions.length > 0\r\n          ? this.selectedOptions[0].data.text\r\n          : this.placeholder;\r\n\r\n      this.dropdown.querySelector(".current").innerHTML = html;\r\n    }\r\n  }\r\n\r\n  _renderItems() {\r\n    const ul = this.dropdown.querySelector("ul");\r\n\r\n    this.options.forEach((item) => {\r\n\r\n      if(this.multiple && this.config.showSelectedItems){\r\n        this._multipleListAdd(item);\r\n      }\r\n\r\n      ul.appendChild(this._renderItem(item));\r\n    });\r\n  }\r\n\r\n  _renderItem(option) {\r\n    const li      = document.createElement("li");\r\n    li.innerHTML  = option.data.text;\r\n\r\n    if (option.data.extra !== undefined) {\r\n      li.appendChild(this._renderItemExtra(option.data.extra));\r\n    }\r\n\r\n    if (option.attributes.optgroup) {\r\n      addClass(li, "optgroup");\r\n    } else {\r\n      li.setAttribute("data-value", option.data.value);\r\n      const classList = ["option"];\r\n      if (option.attributes.selected) classList.push("selected");\r\n      if (option.attributes.disabled) classList.push("disabled");\r\n      li.classList.add(...classList);\r\n      li.addEventListener("click", (e) => this._onItemClicked(option, e));\r\n    }\r\n\r\n    option.element = li;\r\n\r\n    return li;\r\n  }\r\n\r\n  _renderItemExtra(content) {\r\n    const span      = document.createElement("span");\r\n    span.innerHTML  = content;\r\n    addClass(span, "extra");\r\n\r\n    return span;\r\n  }\r\n\r\n  update() {\r\n    this.extractData();\r\n\r\n    if (this.dropdown) {\r\n      const open = hasClass(this.dropdown, "open");\r\n      this.dropdown.remove();\r\n      this.create();\r\n      if (open) {\r\n        triggerClick(this.dropdown);\r\n      }\r\n    }\r\n\r\n    attr(this.el, "disabled") ? this.disable() : this.enable();\r\n  }\r\n\r\n  disable() {\r\n    if (!this.disabled) {\r\n      this.disabled = true;\r\n      addClass(this.dropdown, "disabled");\r\n    }\r\n  }\r\n\r\n  enable() {\r\n    if (this.disabled) {\r\n      this.disabled = false;\r\n      removeClass(this.dropdown, "disabled");\r\n    }\r\n  }\r\n\r\n  clear() {\r\n    this.resetSelectValue();\r\n    this.selectedOptions = [];\r\n    this._renderSelectedItems();\r\n    this.update();\r\n    triggerChange(this.el);\r\n  }\r\n\r\n  destroy() {\r\n    if(this.selectionList){\r\n      this.selectionList.remove();\r\n    }\r\n    \r\n    if (this.dropdown) {\r\n      this.dropdown.remove();\r\n      this.el.style.display = "";\r\n    }\r\n  }\r\n\r\n  focus(target=\'\'){\r\n    const isOpen = hasClass(this.dropdown, "open");\r\n\r\n    if (!isOpen) {\r\n      addClass(this.dropdown, "open");\r\n      triggerModalOpen(this.el);\r\n    } else {\r\n      if (this.multiple) {\r\n        if (target === this.dropdown.querySelector(".multiple-options")) {\r\n          removeClass(this.dropdown, "open");\r\n          triggerModalClose(this.el);\r\n        }\r\n      } else {\r\n        removeClass(this.dropdown, "open");\r\n        triggerModalClose(this.el);\r\n      }\r\n    }\r\n\r\n    if (hasClass(this.dropdown, "open")) {\r\n      const search = this.dropdown.querySelector(".nice-select-search");\r\n\r\n      if (search) {\r\n        search.value = "";\r\n        search.focus();\r\n      }\r\n\r\n      const focused = this.dropdown.querySelector(".focus");\r\n\r\n      if (focused) removeClass(focused, "focus");\r\n\r\n      const selected = this.dropdown.querySelector(".selected");\r\n      if (selected) addClass(selected, "focus");\r\n\r\n      this.dropdown\r\n        .querySelectorAll("ul li")\r\n        .forEach((item) => (item.style.display = ""));\r\n    } else {\r\n      this.dropdown.focus();\r\n    }\r\n  }\r\n\r\n  updateSelect(){\r\n    console.log(\'test\');\r\n    this.update();\r\n  }\r\n\r\n  bindEvent() {\r\n    this.dropdown.addEventListener("click", (e) => this._onClicked(e));\r\n    this.dropdown.addEventListener("keydown", (e) => this._onKeyPressed(e));\r\n    this.dropdown.addEventListener("focusin", () => triggerFocusIn(this.el));\r\n    this.dropdown.addEventListener("focusout", () => triggerFocusOut(this.el));\r\n    this.el.addEventListener("invalid", () => this._triggerValidationMessage("invalid"));\r\n    this.el.addEventListener("change", () => this.updateSelect());\r\n    window.addEventListener("click", (e) => this._onClickedOutside(e));\r\n\r\n    if (this.config.searchable) this._bindSearchEvent();\r\n  }\r\n\r\n  _bindSearchEvent() {\r\n    const searchBox = this.dropdown.querySelector(".nice-select-search");\r\n    if (searchBox) {\r\n      searchBox.addEventListener("click", (e) => e.stopPropagation());\r\n      searchBox.addEventListener("input", (e) => this._onSearchChanged(e));\r\n    }\r\n  }\r\n\r\n  _onClicked(e) {\r\n    e.preventDefault();\r\n\r\n    this.focus(e.target);\r\n  }\r\n\r\n  _onItemClicked(option, e) {\r\n    const optionEl = e.target;\r\n    if (!hasClass(optionEl, "disabled")) {\r\n      if (this.multiple) {\r\n        if (hasClass(optionEl, "selected")) {\r\n          removeClass(optionEl, "selected");\r\n          this.selectedOptions = this.selectedOptions.filter(\r\n            (item) => item !== option\r\n          );\r\n          const opt = this.el.querySelector(\r\n            `option[value="${optionEl.dataset.value}"]`\r\n          );\r\n          if (opt) {\r\n            opt.removeAttribute("selected");\r\n            opt.selected = false;\r\n          }\r\n\r\n          this._multipleListRemove(option);\r\n        } else {\r\n          addClass(optionEl, "selected");\r\n          this.selectedOptions.push(option);\r\n\r\n          if(this.config.showSelectedItems){\r\n            option.attributes.selected = true;\r\n            this._multipleListAdd(option);\r\n          }\r\n        }\r\n      } else {\r\n        this.options.forEach((item) => removeClass(item.element, "selected"));\r\n\r\n        addClass(optionEl, "selected");\r\n\r\n        this.selectedOptions = [option];\r\n      }\r\n\r\n      this._renderSelectedItems();\r\n\r\n      this.updateSelectValue();\r\n    }\r\n  }\r\n\r\n  setValue(value) {\r\n    const select = this.el;\r\n    let noSelected = true;\r\n\r\n    // Validate input type\r\n    if (select.multiple) {\r\n      if (!Array.isArray(value)) {\r\n        throw new Error(\'setValue expects an array for multiple select elements\');\r\n      }\r\n\r\n      value = value.map(String);\r\n    } else {\r\n      if (Array.isArray(value)) {\r\n        throw new Error(\'setValue expects a single value for non-multiple select elements\');\r\n      }\r\n\r\n      if (value !== null && value !== undefined && typeof value !== \'string\' && typeof value !== \'number\') {\r\n        throw new Error(\'setValue expects a string or number for non-multiple select elements\');\r\n      }\r\n\r\n      value = String(value);\r\n    }\r\n\r\n    for (const opt of select.options) {\r\n      const currentValue = select.multiple\r\n        ? value.includes(opt.value)\r\n          ? opt.value\r\n          : null\r\n        : value;\r\n      if (opt.value === currentValue && !opt.disabled) {\r\n        if (noSelected) {\r\n          select.value = currentValue;\r\n          noSelected = false;\r\n        }\r\n\r\n        opt.setAttribute("selected", true);\r\n        opt.selected = true;\r\n      } else {\r\n        opt.removeAttribute("selected");\r\n        opt.selected = false;\r\n      }\r\n    }\r\n\r\n    if (noSelected && !select.multiple && select.options.length) {\r\n      select.options[0].setAttribute("selected", true);\r\n      select.options[0].selected = true;\r\n      select.value = select.options[0].value;\r\n    }\r\n\r\n    this.update();\r\n  }\r\n\r\n  getValue() {\r\n    const select = this.el;\r\n    if (!select.multiple) return select.value;\r\n\r\n    return Array.from(select.options)\r\n      .filter((opt) => opt.selected)\r\n      .map((opt) => opt.value);\r\n  }\r\n\r\n  updateSelectValue() {\r\n    if (this.selectedOptions.length > 0) {\r\n      this.el.value = this.selectedOptions[0].data.value;\r\n    }\r\n\r\n    const select = this.el;\r\n\r\n    // FIrst mark all options as not selected\r\n    select.querySelectorAll("option").forEach(function (item) {\r\n      item.removeAttribute("selected");\r\n    });\r\n\r\n    // Mark the selected options as selected in the select element\r\n    this.selectedOptions.forEach( item => {\r\n      let el = select.querySelector(`option[value="${item.data.value}"]`);\r\n\r\n      if (el){\r\n        //Change it, cause it works more correctly.\r\n        el.setAttribute("selected", "selected");\r\n        el.selected = true;\r\n      }\r\n    });\r\n\r\n    triggerChange(this.el);\r\n  }\r\n\r\n  resetSelectValue() {\r\n    if (this.multiple) {\r\n      const select = this.el;\r\n      this.selectedOptions.forEach((item) => {\r\n        const el = select.querySelector(`option[value="${item.data.value}"]`);\r\n        if (el) {\r\n          el.removeAttribute("selected");\r\n          el.selected = false;\r\n        }\r\n      });\r\n    } else if (this.selectedOptions.length > 0) {\r\n      this.el.selectedIndex = -1;\r\n    }\r\n\r\n    triggerChange(this.el);\r\n  }\r\n\r\n  _onClickedOutside(e) {\r\n    if (!this.dropdown.contains(e.target)) {\r\n      removeClass(this.dropdown, "open");\r\n      triggerModalClose(this.el);\r\n    }\r\n  }\r\n\r\n  _onKeyPressed(e) {\r\n    const focusedOption = this.dropdown.querySelector(".focus");\r\n    const isOpen = hasClass(this.dropdown, "open");\r\n\r\n    if (e.keyCode === 13) {\r\n      isOpen ? triggerClick(focusedOption) : triggerClick(this.dropdown);\r\n    } else if (e.keyCode === 40) {\r\n      if (!isOpen) {\r\n        triggerClick(this.dropdown);\r\n      } else {\r\n        const next = this._findNext(focusedOption);\r\n        if (next) {\r\n          if (focusedOption) removeClass(focusedOption, "focus");\r\n          addClass(next, "focus");\r\n        }\r\n      }\r\n      e.preventDefault();\r\n    } else if (e.keyCode === 38) {\r\n      if (!isOpen) {\r\n        triggerClick(this.dropdown);\r\n      } else {\r\n        const prev = this._findPrev(focusedOption);\r\n        if (prev) {\r\n          if (focusedOption) removeClass(focusedOption, "focus");\r\n          addClass(prev, "focus");\r\n        }\r\n      }\r\n      e.preventDefault();\r\n    } else if (e.keyCode === 27 && isOpen) {\r\n      triggerClick(this.dropdown);\r\n    } else if (e.keyCode === 32 && isOpen) {\r\n      return false;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  _findNext(el) {\r\n    let nextEl = el\r\n      ? el.nextElementSibling\r\n      : this.dropdown.querySelector(".list .option");\r\n    while (nextEl) {\r\n      if (!hasClass(nextEl, "disabled") && nextEl.style.display !== "none")\r\n        return nextEl;\r\n      nextEl = nextEl.nextElementSibling;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  _findPrev(el) {\r\n    let prevEl = el\r\n      ? el.previousElementSibling\r\n      : this.dropdown.querySelector(".list .option:last-child");\r\n    while (prevEl) {\r\n      if (!hasClass(prevEl, "disabled") && prevEl.style.display !== "none")\r\n        return prevEl;\r\n      prevEl = prevEl.previousElementSibling;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  _onSearchChanged(e) {\r\n    const text = e.target.value.toLowerCase();\r\n\r\n    if (text === "") {\r\n      this.options.forEach((item) => (item.element.style.display = ""));\r\n    } else if (hasClass(this.dropdown, "open")) {\r\n      const matchReg = new RegExp(text);\r\n      this.options.forEach((item) => {\r\n        item.element.style.display = matchReg.test(item.data.text.toLowerCase())\r\n          ? ""\r\n          : "none";\r\n      });\r\n    }\r\n\r\n    this.dropdown\r\n      .querySelectorAll(".focus")\r\n      .forEach((item) => removeClass(item, "focus"));\r\n\r\n    const firstEl = this._findNext(null);\r\n\r\n    if (firstEl) addClass(firstEl, "focus");\r\n  }\r\n\r\n  _triggerValidationMessage(type) {\r\n    if (type === "invalid") {\r\n      addClass(this.dropdown, "invalid");\r\n      removeClass(this.dropdown, "valid");\r\n    } else {\r\n      addClass(this.dropdown, "valid");\r\n      removeClass(this.dropdown, "invalid");\r\n    }\r\n  }\r\n\r\n  _multipleListAdd(option) {\r\n  \r\n    if(option.data.disabled || option.data.value == "" || !option.attributes.selected){\r\n      return;\r\n    }\r\n\r\n    if(this.selectionList == null){\r\n      this.selectionList\t \t\t= document.createElement(\'ul\');\r\n      this.selectionList.classList.add(\'select-selection-list\');\r\n\r\n      this.el.after(this.selectionList);\r\n    }else if(this.selectionList.querySelector(`[data-value="${option.data.value}"]`) != null){\r\n      return;\r\n    }\r\n\r\n    let li\t \t\t= document.createElement(\'li\');\r\n    li.classList.add(\'select-selection\');\r\n\r\n    li.dataset.value = option.data.value;\r\n\r\n    let html\t  = `\r\n      <button type="button" class="small remove-select-selection">\r\n        <span class=\'remove-select-selection\'>×</span>\r\n      </button>\r\n    `;\r\n\r\n    // Add\r\n    html   += `<span class=\'selected-name\'>${option.data.text}</span>`\r\n\r\n    li.innerHTML\t= html;\r\n\r\n    this.selectionList.appendChild(li);\r\n\r\n    li.querySelectorAll(\'.remove-select-selection\').forEach(el=> el.addEventListener("click", this._multipleListRemove.bind(this)));\r\n  }\r\n\r\n  _multipleListRemove(target) {\r\n\r\n    if(target.target != null){\r\n      target  = target.target;\r\n    }\r\n\r\n    if(target.data == undefined){\r\n      target.closest(\'li.select-selection\').remove();\r\n\r\n      let parent  = target.closest(\'li.select-selection\');\r\n\r\n      this.selectedOptions.forEach(option => {\r\n        if(option.data.value == parent.dataset.value){\r\n          removeClass(option.element, "selected");\r\n          this.selectedOptions.splice(this.selectedOptions.indexOf(option), 1);\r\n          var opt = this.el.querySelector(`option[value="${option.data.value}"]`);\r\n          opt.removeAttribute(\'selected\');\r\n          opt.selected = false;\r\n        }\r\n\r\n        this._renderSelectedItems();\r\n      })\r\n\r\n      return;\r\n    }\r\n\r\n    if(target.element.classList.contains(\'selected\')){\r\n      console.log(target);\r\n      return;\r\n    }\r\n\r\n    let parent  = this.el.parentElement;\r\n    \r\n    let ul      = parent.querySelector(\'.select-selection-list\');\r\n    \r\n    target  = ul.querySelector(`[data-value="${target.data.value}"]`);\r\n\r\n    if(ul != null && target != null){\r\n      target.remove();\r\n    }\r\n\r\n  }\r\n}\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (NiceSelect);\r\nfunction bind(el, options) {\r\n  return new NiceSelect(el, options);\r\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsdUJBQXVCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxxREFBcUQsZ0JBQWdCO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlELGdCQUFnQjtBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyx5REFBeUQsa0JBQWtCO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxpQkFBaUI7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxrQkFBa0I7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxrQkFBa0I7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFlLFVBQVUsRUFBQztBQUNuQjtBQUNQO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9OaWNlU2VsZWN0Ly4vc3JjL2pzL25pY2Utc2VsZWN0Mi5qcz9iNGM4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcIi4uL3Njc3MvbmljZS1zZWxlY3QyLnNjc3NcIjtcclxuXHJcbmNvbnN0IHRyaWdnZXJFdmVudCAgICAgID0gKGVsLCB0eXBlLCBpbml0ID0ge30pID0+IHtcclxuICBsZXQgRXZlbnRDb25zdHJ1Y3RvcjtcclxuICBpZiAodHlwZSA9PT0gXCJjbGlja1wiKSB7XHJcbiAgICBFdmVudENvbnN0cnVjdG9yID0gTW91c2VFdmVudDtcclxuICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiY2hhbmdlXCIpIHtcclxuICAgIEV2ZW50Q29uc3RydWN0b3IgPSBFdmVudDtcclxuICB9IGVsc2UgaWYgKHR5cGUuaW5jbHVkZXMoXCJmb2N1c1wiKSkge1xyXG4gICAgRXZlbnRDb25zdHJ1Y3RvciA9IEZvY3VzRXZlbnQ7XHJcbiAgfSBlbHNlIHtcclxuICAgIEV2ZW50Q29uc3RydWN0b3IgPSBVSUV2ZW50O1xyXG4gIH1cclxuICBjb25zdCBldmVudCA9IG5ldyBFdmVudENvbnN0cnVjdG9yKHR5cGUsIHtcclxuICAgIGJ1YmJsZXM6IHRydWUsXHJcbiAgICBjYW5jZWxhYmxlOiBmYWxzZSxcclxuICAgIC4uLmluaXQsXHJcbiAgfSk7XHJcbiAgZWwuZGlzcGF0Y2hFdmVudChldmVudCk7XHJcbn07XHJcblxyXG5jb25zdCB0cmlnZ2VyQ2xpY2sgICAgICA9IChlbCkgPT4gdHJpZ2dlckV2ZW50KGVsLCBcImNsaWNrXCIpO1xyXG5jb25zdCB0cmlnZ2VyQ2hhbmdlICAgICA9IChlbCkgPT4gdHJpZ2dlckV2ZW50KGVsLCBcImNoYW5nZVwiKTtcclxuY29uc3QgdHJpZ2dlckZvY3VzSW4gICAgPSAoZWwpID0+IHRyaWdnZXJFdmVudChlbCwgXCJmb2N1c2luXCIpO1xyXG5jb25zdCB0cmlnZ2VyRm9jdXNPdXQgICA9IChlbCkgPT4gdHJpZ2dlckV2ZW50KGVsLCBcImZvY3Vzb3V0XCIpO1xyXG5jb25zdCB0cmlnZ2VyTW9kYWxPcGVuICA9IChlbCkgPT4gdHJpZ2dlckV2ZW50KGVsLCBcIm1vZGFsb3BlblwiKTtcclxuY29uc3QgdHJpZ2dlck1vZGFsQ2xvc2UgPSAoZWwpID0+IHRyaWdnZXJFdmVudChlbCwgXCJtb2RhbGNsb3NlXCIpO1xyXG5cclxuY29uc3QgYXR0ciAgICAgICAgICAgICAgPSAoZWwsIGtleSkgPT4gZWxba2V5XSAhPT0gdW5kZWZpbmVkID8gZWxba2V5XSA6IGVsLmdldEF0dHJpYnV0ZShrZXkpO1xyXG5jb25zdCBkYXRhICAgICAgICAgICAgICA9IChlbCwga2V5KSA9PiBlbC5nZXRBdHRyaWJ1dGUoXCJkYXRhLVwiICsga2V5KTtcclxuY29uc3QgaGFzQ2xhc3MgICAgICAgICAgPSAoZWwsIGNsYXNzTmFtZSkgPT4gZWw/LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpO1xyXG5jb25zdCBhZGRDbGFzcyAgICAgICAgICA9IChlbCwgY2xhc3NOYW1lKSA9PiBlbD8uY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xyXG5jb25zdCByZW1vdmVDbGFzcyAgICAgICA9IChlbCwgY2xhc3NOYW1lKSA9PiBlbD8uY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xyXG5cclxuY29uc3QgZGVmYXVsdE9wdGlvbnMgPSB7XHJcbiAgZGF0YTogbnVsbCxcclxuICBzZWFyY2hhYmxlOiB0cnVlLFxyXG4gIHNob3dTZWxlY3RlZEl0ZW1zOiB0cnVlLFxyXG4gIHBsYWNlaG9sZGVyOiBcIlNlbGVjdCBhbiBvcHRpb25cIixcclxuICBzZWFyY2h0ZXh0OiBcIlNlYXJjaFwiLFxyXG4gIHNlbGVjdGVkdGV4dDogXCJzZWxlY3RlZFwiLFxyXG59O1xyXG5cclxuY2xhc3MgTmljZVNlbGVjdCB7XHJcbiAgY29uc3RydWN0b3IoZWxlbWVudCwgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICBpZiAoIWVsZW1lbnQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBlbGVtZW50IHByb3ZpZGVkIHRvIE5pY2VTZWxlY3QnKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIShlbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGVsZW1lbnQgcHJvdmlkZWQgdG8gTmljZVNlbGVjdCAtIG11c3QgYmUgYSB2YWxpZCBET00gZWxlbWVudCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZWwgICAgICAgICAgICAgICA9IGVsZW1lbnQ7XHJcbiAgICB0aGlzLmNvbmZpZyAgICAgICAgICAgPSB7IC4uLmRlZmF1bHRPcHRpb25zLCAuLi5vcHRpb25zIH07XHJcbiAgICB0aGlzLmRhdGEgICAgICAgICAgICAgPSB0aGlzLmNvbmZpZy5kYXRhO1xyXG4gICAgdGhpcy5zZWxlY3RlZE9wdGlvbnMgID0gW107XHJcbiAgICB0aGlzLnBsYWNlaG9sZGVyICAgICAgPSBhdHRyKHRoaXMuZWwsIFwicGxhY2Vob2xkZXJcIikgfHwgdGhpcy5jb25maWcucGxhY2Vob2xkZXI7XHJcbiAgICB0aGlzLnNlYXJjaHRleHQgICAgICAgPSBhdHRyKHRoaXMuZWwsIFwic2VhcmNodGV4dFwiKSB8fCB0aGlzLmNvbmZpZy5zZWFyY2h0ZXh0O1xyXG4gICAgdGhpcy5zZWxlY3RlZHRleHQgICAgID0gYXR0cih0aGlzLmVsLCBcInNlbGVjdGVkdGV4dFwiKSB8fCB0aGlzLmNvbmZpZy5zZWxlY3RlZHRleHQ7XHJcbiAgICB0aGlzLmRyb3Bkb3duICAgICAgICAgPSBudWxsO1xyXG4gICAgdGhpcy5zZWxlY3Rpb25MaXN0ICAgID0gbnVsbDtcclxuICAgIHRoaXMubXVsdGlwbGUgICAgICAgICA9IGF0dHIodGhpcy5lbCwgXCJtdWx0aXBsZVwiKTtcclxuICAgIHRoaXMuZGlzYWJsZWQgICAgICAgICA9IGF0dHIodGhpcy5lbCwgXCJkaXNhYmxlZFwiKTtcclxuICAgIHRoaXMuY3JlYXRlKCk7XHJcbiAgfVxyXG5cclxuICBjcmVhdGUoKSB7XHJcbiAgICBPYmplY3QuYXNzaWduKHRoaXMuZWwuc3R5bGUsIHtcclxuICAgICAgb3BhY2l0eTogXCIwXCIsXHJcbiAgICAgIHdpZHRoOiBcIjBcIixcclxuICAgICAgcGFkZGluZzogXCIwXCIsXHJcbiAgICAgIGhlaWdodDogXCIwXCIsXHJcbiAgICAgIGZvbnRTaXplOiBcIjBcIixcclxuICAgICAgbWluSGVpZ2h0OiBcImF1dG9cIixcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuZGF0YSA/IHRoaXMucHJvY2Vzc0RhdGEodGhpcy5kYXRhKSA6IHRoaXMuZXh0cmFjdERhdGEoKTtcclxuICAgIHRoaXMucmVuZGVyRHJvcGRvd24oKTtcclxuICAgIHRoaXMuYmluZEV2ZW50KCk7XHJcbiAgfVxyXG5cclxuICBwcm9jZXNzRGF0YShkYXRhKSB7XHJcbiAgICB0aGlzLm9wdGlvbnMgPSBkYXRhLm1hcCgoaXRlbSkgPT4gKHtcclxuICAgICAgZGF0YTogaXRlbSxcclxuICAgICAgYXR0cmlidXRlczoge1xyXG4gICAgICAgIHNlbGVjdGVkOiAhIWl0ZW0uc2VsZWN0ZWQsXHJcbiAgICAgICAgZGlzYWJsZWQ6ICEhaXRlbS5kaXNhYmxlZCxcclxuICAgICAgICBvcHRncm91cDogaXRlbS52YWx1ZSA9PT0gXCJvcHRncm91cFwiLFxyXG4gICAgICB9LFxyXG4gICAgfSkpO1xyXG4gIH1cclxuXHJcbiAgZXh0cmFjdERhdGEoKSB7XHJcbiAgICBjb25zdCBvcHRpb25zID0gQXJyYXkuZnJvbSh0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCJvcHRpb24sb3B0Z3JvdXBcIikpO1xyXG4gICAgY29uc3QgYWxsT3B0aW9ucyA9IFtdO1xyXG4gICAgY29uc3Qgc2VsZWN0ZWRPcHRpb25zID0gW107XHJcblxyXG4gICAgdGhpcy5kYXRhID0gb3B0aW9ucy5tYXAoKGl0ZW0pID0+IHtcclxuICAgICAgbGV0IGl0ZW1EYXRhO1xyXG5cclxuICAgICAgaWYgKGl0ZW0udGFnTmFtZSA9PT0gXCJPUFRHUk9VUFwiKSB7XHJcbiAgICAgICAgaXRlbURhdGEgPSB7IHRleHQ6IGl0ZW0ubGFiZWwsIHZhbHVlOiBcIm9wdGdyb3VwXCIgfTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zdCB0ZXh0ID0gaXRlbS5kYXRhc2V0LmRpc3BsYXkgPz8gaXRlbS5pbm5lclRleHQ7XHJcbiAgICAgICAgaXRlbURhdGEgPSB7XHJcbiAgICAgICAgICB0ZXh0LFxyXG4gICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXHJcbiAgICAgICAgICBleHRyYTogaXRlbS5kYXRhc2V0LmV4dHJhLFxyXG4gICAgICAgICAgc2VsZWN0ZWQ6IGl0ZW0uaGFzQXR0cmlidXRlKFwic2VsZWN0ZWRcIiksXHJcbiAgICAgICAgICBkaXNhYmxlZDogaXRlbS5oYXNBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKSxcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBhdHRyaWJ1dGVzID0ge1xyXG4gICAgICAgIHNlbGVjdGVkOiBpdGVtLmhhc0F0dHJpYnV0ZShcInNlbGVjdGVkXCIpLFxyXG4gICAgICAgIGRpc2FibGVkOiBpdGVtLmhhc0F0dHJpYnV0ZShcImRpc2FibGVkXCIpLFxyXG4gICAgICAgIG9wdGdyb3VwOiBpdGVtLnRhZ05hbWUgPT09IFwiT1BUR1JPVVBcIixcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IG9wdGlvbk9iaiA9IHsgZGF0YTogaXRlbURhdGEsIGF0dHJpYnV0ZXMsIGVsZW1lbnQ6IG51bGwgfTtcclxuXHJcbiAgICAgIGFsbE9wdGlvbnMucHVzaChvcHRpb25PYmopO1xyXG5cclxuICAgICAgaWYgKGF0dHJpYnV0ZXMuc2VsZWN0ZWQpIHNlbGVjdGVkT3B0aW9ucy5wdXNoKG9wdGlvbk9iaik7XHJcblxyXG4gICAgICByZXR1cm4gaXRlbURhdGE7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLm9wdGlvbnMgICAgICAgICAgPSBhbGxPcHRpb25zO1xyXG4gICAgdGhpcy5zZWxlY3RlZE9wdGlvbnMgID0gc2VsZWN0ZWRPcHRpb25zO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyRHJvcGRvd24oKSB7XHJcbiAgICBjb25zdCBjbGFzc2VzID0gW1xyXG4gICAgICBcIm5pY2Utc2VsZWN0XCIsXHJcbiAgICAgIGF0dHIodGhpcy5lbCwgXCJjbGFzc1wiKSB8fCBcIlwiLFxyXG4gICAgICB0aGlzLmRpc2FibGVkID8gXCJkaXNhYmxlZFwiIDogXCJcIixcclxuICAgICAgdGhpcy5tdWx0aXBsZSA/IFwiaGFzLW11bHRpcGxlXCIgOiBcIlwiLFxyXG4gICAgXS5maWx0ZXIoQm9vbGVhbik7XHJcblxyXG4gICAgY29uc3Qgc2VhcmNoSHRtbCA9IHRoaXMuY29uZmlnLnNlYXJjaGFibGVcclxuICAgICAgPyBgXHJcbiAgICAgIDxkaXYgY2xhc3M9XCJuaWNlLXNlbGVjdC1zZWFyY2gtYm94XCI+XHJcbiAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJuaWNlLXNlbGVjdC1zZWFyY2hcIiBwbGFjZWhvbGRlcj1cIiR7dGhpcy5zZWFyY2h0ZXh0fS4uLlwiIHRpdGxlPVwic2VhcmNoXCIvPlxyXG4gICAgICA8L2Rpdj5cclxuICAgIGBcclxuICAgICAgOiBcIlwiO1xyXG5cclxuICAgIGNvbnN0IGh0bWwgPSBgXHJcbiAgICAgIDxkaXYgY2xhc3M9XCIke2NsYXNzZXMuam9pbihcIiBcIil9XCIgdGFiaW5kZXg9XCIke3RoaXMuZGlzYWJsZWQgPyBcIlwiIDogMH1cIj5cclxuICAgICAgICA8c3BhbiBjbGFzcz1cIiR7dGhpcy5tdWx0aXBsZSA/IFwibXVsdGlwbGUtb3B0aW9uc1wiIDogXCJjdXJyZW50XCJ9XCI+PC9zcGFuPlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJuaWNlLXNlbGVjdC1kcm9wZG93blwiPlxyXG4gICAgICAgICAgJHtzZWFyY2hIdG1sfVxyXG4gICAgICAgICAgPHVsIGNsYXNzPVwibGlzdFwiPjwvdWw+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgYDtcclxuXHJcbiAgICB0aGlzLmVsLmluc2VydEFkamFjZW50SFRNTChcImFmdGVyZW5kXCIsIGh0bWwpO1xyXG5cclxuICAgIHRoaXMuZHJvcGRvd24gPSB0aGlzLmVsLm5leHRFbGVtZW50U2libGluZztcclxuXHJcbiAgICB0aGlzLl9yZW5kZXJTZWxlY3RlZEl0ZW1zKCk7XHJcblxyXG4gICAgdGhpcy5fcmVuZGVySXRlbXMoKTtcclxuICB9XHJcblxyXG4gIF9yZW5kZXJTZWxlY3RlZEl0ZW1zKCkge1xyXG4gICAgaWYgKHRoaXMubXVsdGlwbGUpIHtcclxuICAgICAgbGV0IHNlbGVjdGVkSHRtbCA9IFwiXCI7XHJcblxyXG4gICAgICBpZiAoXHJcbiAgICAgICAgd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5kcm9wZG93bikud2lkdGggPT09IFwiYXV0b1wiIHx8XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZE9wdGlvbnMubGVuZ3RoIDwgMlxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucy5mb3JFYWNoKCAoaXRlbSwgaW5kZXgsIGFycmF5KSA9PiB7XHJcbiAgICAgICAgICBsZXQgdGV4dCAgPSBpdGVtLmRhdGEudGV4dDtcclxuXHJcbiAgICAgICAgICBpZihpbmRleCAhPT0gYXJyYXkubGVuZ3RoIC0xICl7XHJcbiAgICAgICAgICAgIHRleHQgKz0gYCwgYDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBzZWxlY3RlZEh0bWwgKz0gYDxzcGFuIGNsYXNzPVwiY3VycmVudFwiPiR7dGV4dH08L3NwYW4+YDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgc2VsZWN0ZWRIdG1sID0gc2VsZWN0ZWRIdG1sIHx8IHRoaXMucGxhY2Vob2xkZXI7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc2VsZWN0ZWRIdG1sID0gYCR7dGhpcy5zZWxlY3RlZE9wdGlvbnMubGVuZ3RofSAke3RoaXMuc2VsZWN0ZWR0ZXh0fWA7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMuZHJvcGRvd24ucXVlcnlTZWxlY3RvcihcIi5tdWx0aXBsZS1vcHRpb25zXCIpLmlubmVySFRNTCA9IHNlbGVjdGVkSHRtbDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnN0IGh0bWwgPVxyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zLmxlbmd0aCA+IDBcclxuICAgICAgICAgID8gdGhpcy5zZWxlY3RlZE9wdGlvbnNbMF0uZGF0YS50ZXh0XHJcbiAgICAgICAgICA6IHRoaXMucGxhY2Vob2xkZXI7XHJcblxyXG4gICAgICB0aGlzLmRyb3Bkb3duLnF1ZXJ5U2VsZWN0b3IoXCIuY3VycmVudFwiKS5pbm5lckhUTUwgPSBodG1sO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3JlbmRlckl0ZW1zKCkge1xyXG4gICAgY29uc3QgdWwgPSB0aGlzLmRyb3Bkb3duLnF1ZXJ5U2VsZWN0b3IoXCJ1bFwiKTtcclxuXHJcbiAgICB0aGlzLm9wdGlvbnMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG5cclxuICAgICAgaWYodGhpcy5tdWx0aXBsZSAmJiB0aGlzLmNvbmZpZy5zaG93U2VsZWN0ZWRJdGVtcyl7XHJcbiAgICAgICAgdGhpcy5fbXVsdGlwbGVMaXN0QWRkKGl0ZW0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB1bC5hcHBlbmRDaGlsZCh0aGlzLl9yZW5kZXJJdGVtKGl0ZW0pKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckl0ZW0ob3B0aW9uKSB7XHJcbiAgICBjb25zdCBsaSAgICAgID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpO1xyXG4gICAgbGkuaW5uZXJIVE1MICA9IG9wdGlvbi5kYXRhLnRleHQ7XHJcblxyXG4gICAgaWYgKG9wdGlvbi5kYXRhLmV4dHJhICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgbGkuYXBwZW5kQ2hpbGQodGhpcy5fcmVuZGVySXRlbUV4dHJhKG9wdGlvbi5kYXRhLmV4dHJhKSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG9wdGlvbi5hdHRyaWJ1dGVzLm9wdGdyb3VwKSB7XHJcbiAgICAgIGFkZENsYXNzKGxpLCBcIm9wdGdyb3VwXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbGkuc2V0QXR0cmlidXRlKFwiZGF0YS12YWx1ZVwiLCBvcHRpb24uZGF0YS52YWx1ZSk7XHJcbiAgICAgIGNvbnN0IGNsYXNzTGlzdCA9IFtcIm9wdGlvblwiXTtcclxuICAgICAgaWYgKG9wdGlvbi5hdHRyaWJ1dGVzLnNlbGVjdGVkKSBjbGFzc0xpc3QucHVzaChcInNlbGVjdGVkXCIpO1xyXG4gICAgICBpZiAob3B0aW9uLmF0dHJpYnV0ZXMuZGlzYWJsZWQpIGNsYXNzTGlzdC5wdXNoKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgIGxpLmNsYXNzTGlzdC5hZGQoLi4uY2xhc3NMaXN0KTtcclxuICAgICAgbGkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB0aGlzLl9vbkl0ZW1DbGlja2VkKG9wdGlvbiwgZSkpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wdGlvbi5lbGVtZW50ID0gbGk7XHJcblxyXG4gICAgcmV0dXJuIGxpO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckl0ZW1FeHRyYShjb250ZW50KSB7XHJcbiAgICBjb25zdCBzcGFuICAgICAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcclxuICAgIHNwYW4uaW5uZXJIVE1MICA9IGNvbnRlbnQ7XHJcbiAgICBhZGRDbGFzcyhzcGFuLCBcImV4dHJhXCIpO1xyXG5cclxuICAgIHJldHVybiBzcGFuO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlKCkge1xyXG4gICAgdGhpcy5leHRyYWN0RGF0YSgpO1xyXG5cclxuICAgIGlmICh0aGlzLmRyb3Bkb3duKSB7XHJcbiAgICAgIGNvbnN0IG9wZW4gPSBoYXNDbGFzcyh0aGlzLmRyb3Bkb3duLCBcIm9wZW5cIik7XHJcbiAgICAgIHRoaXMuZHJvcGRvd24ucmVtb3ZlKCk7XHJcbiAgICAgIHRoaXMuY3JlYXRlKCk7XHJcbiAgICAgIGlmIChvcGVuKSB7XHJcbiAgICAgICAgdHJpZ2dlckNsaWNrKHRoaXMuZHJvcGRvd24pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYXR0cih0aGlzLmVsLCBcImRpc2FibGVkXCIpID8gdGhpcy5kaXNhYmxlKCkgOiB0aGlzLmVuYWJsZSgpO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZSgpIHtcclxuICAgIGlmICghdGhpcy5kaXNhYmxlZCkge1xyXG4gICAgICB0aGlzLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgYWRkQ2xhc3ModGhpcy5kcm9wZG93biwgXCJkaXNhYmxlZFwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGVuYWJsZSgpIHtcclxuICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgcmVtb3ZlQ2xhc3ModGhpcy5kcm9wZG93biwgXCJkaXNhYmxlZFwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsZWFyKCkge1xyXG4gICAgdGhpcy5yZXNldFNlbGVjdFZhbHVlKCk7XHJcbiAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucyA9IFtdO1xyXG4gICAgdGhpcy5fcmVuZGVyU2VsZWN0ZWRJdGVtcygpO1xyXG4gICAgdGhpcy51cGRhdGUoKTtcclxuICAgIHRyaWdnZXJDaGFuZ2UodGhpcy5lbCk7XHJcbiAgfVxyXG5cclxuICBkZXN0cm95KCkge1xyXG4gICAgaWYodGhpcy5zZWxlY3Rpb25MaXN0KXtcclxuICAgICAgdGhpcy5zZWxlY3Rpb25MaXN0LnJlbW92ZSgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAodGhpcy5kcm9wZG93bikge1xyXG4gICAgICB0aGlzLmRyb3Bkb3duLnJlbW92ZSgpO1xyXG4gICAgICB0aGlzLmVsLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZm9jdXModGFyZ2V0PScnKXtcclxuICAgIGNvbnN0IGlzT3BlbiA9IGhhc0NsYXNzKHRoaXMuZHJvcGRvd24sIFwib3BlblwiKTtcclxuXHJcbiAgICBpZiAoIWlzT3Blbikge1xyXG4gICAgICBhZGRDbGFzcyh0aGlzLmRyb3Bkb3duLCBcIm9wZW5cIik7XHJcbiAgICAgIHRyaWdnZXJNb2RhbE9wZW4odGhpcy5lbCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAodGhpcy5tdWx0aXBsZSkge1xyXG4gICAgICAgIGlmICh0YXJnZXQgPT09IHRoaXMuZHJvcGRvd24ucXVlcnlTZWxlY3RvcihcIi5tdWx0aXBsZS1vcHRpb25zXCIpKSB7XHJcbiAgICAgICAgICByZW1vdmVDbGFzcyh0aGlzLmRyb3Bkb3duLCBcIm9wZW5cIik7XHJcbiAgICAgICAgICB0cmlnZ2VyTW9kYWxDbG9zZSh0aGlzLmVsKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVtb3ZlQ2xhc3ModGhpcy5kcm9wZG93biwgXCJvcGVuXCIpO1xyXG4gICAgICAgIHRyaWdnZXJNb2RhbENsb3NlKHRoaXMuZWwpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGhhc0NsYXNzKHRoaXMuZHJvcGRvd24sIFwib3BlblwiKSkge1xyXG4gICAgICBjb25zdCBzZWFyY2ggPSB0aGlzLmRyb3Bkb3duLnF1ZXJ5U2VsZWN0b3IoXCIubmljZS1zZWxlY3Qtc2VhcmNoXCIpO1xyXG5cclxuICAgICAgaWYgKHNlYXJjaCkge1xyXG4gICAgICAgIHNlYXJjaC52YWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgc2VhcmNoLmZvY3VzKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGZvY3VzZWQgPSB0aGlzLmRyb3Bkb3duLnF1ZXJ5U2VsZWN0b3IoXCIuZm9jdXNcIik7XHJcblxyXG4gICAgICBpZiAoZm9jdXNlZCkgcmVtb3ZlQ2xhc3MoZm9jdXNlZCwgXCJmb2N1c1wiKTtcclxuXHJcbiAgICAgIGNvbnN0IHNlbGVjdGVkID0gdGhpcy5kcm9wZG93bi5xdWVyeVNlbGVjdG9yKFwiLnNlbGVjdGVkXCIpO1xyXG4gICAgICBpZiAoc2VsZWN0ZWQpIGFkZENsYXNzKHNlbGVjdGVkLCBcImZvY3VzXCIpO1xyXG5cclxuICAgICAgdGhpcy5kcm9wZG93blxyXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKFwidWwgbGlcIilcclxuICAgICAgICAuZm9yRWFjaCgoaXRlbSkgPT4gKGl0ZW0uc3R5bGUuZGlzcGxheSA9IFwiXCIpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZHJvcGRvd24uZm9jdXMoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHVwZGF0ZVNlbGVjdCgpe1xyXG4gICAgY29uc29sZS5sb2coJ3Rlc3QnKTtcclxuICAgIHRoaXMudXBkYXRlKCk7XHJcbiAgfVxyXG5cclxuICBiaW5kRXZlbnQoKSB7XHJcbiAgICB0aGlzLmRyb3Bkb3duLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4gdGhpcy5fb25DbGlja2VkKGUpKTtcclxuICAgIHRoaXMuZHJvcGRvd24uYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHRoaXMuX29uS2V5UHJlc3NlZChlKSk7XHJcbiAgICB0aGlzLmRyb3Bkb3duLmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c2luXCIsICgpID0+IHRyaWdnZXJGb2N1c0luKHRoaXMuZWwpKTtcclxuICAgIHRoaXMuZHJvcGRvd24uYWRkRXZlbnRMaXN0ZW5lcihcImZvY3Vzb3V0XCIsICgpID0+IHRyaWdnZXJGb2N1c091dCh0aGlzLmVsKSk7XHJcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnZhbGlkXCIsICgpID0+IHRoaXMuX3RyaWdnZXJWYWxpZGF0aW9uTWVzc2FnZShcImludmFsaWRcIikpO1xyXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHRoaXMudXBkYXRlU2VsZWN0KCkpO1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4gdGhpcy5fb25DbGlja2VkT3V0c2lkZShlKSk7XHJcblxyXG4gICAgaWYgKHRoaXMuY29uZmlnLnNlYXJjaGFibGUpIHRoaXMuX2JpbmRTZWFyY2hFdmVudCgpO1xyXG4gIH1cclxuXHJcbiAgX2JpbmRTZWFyY2hFdmVudCgpIHtcclxuICAgIGNvbnN0IHNlYXJjaEJveCA9IHRoaXMuZHJvcGRvd24ucXVlcnlTZWxlY3RvcihcIi5uaWNlLXNlbGVjdC1zZWFyY2hcIik7XHJcbiAgICBpZiAoc2VhcmNoQm94KSB7XHJcbiAgICAgIHNlYXJjaEJveC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IGUuc3RvcFByb3BhZ2F0aW9uKCkpO1xyXG4gICAgICBzZWFyY2hCb3guYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB0aGlzLl9vblNlYXJjaENoYW5nZWQoZSkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX29uQ2xpY2tlZChlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgdGhpcy5mb2N1cyhlLnRhcmdldCk7XHJcbiAgfVxyXG5cclxuICBfb25JdGVtQ2xpY2tlZChvcHRpb24sIGUpIHtcclxuICAgIGNvbnN0IG9wdGlvbkVsID0gZS50YXJnZXQ7XHJcbiAgICBpZiAoIWhhc0NsYXNzKG9wdGlvbkVsLCBcImRpc2FibGVkXCIpKSB7XHJcbiAgICAgIGlmICh0aGlzLm11bHRpcGxlKSB7XHJcbiAgICAgICAgaWYgKGhhc0NsYXNzKG9wdGlvbkVsLCBcInNlbGVjdGVkXCIpKSB7XHJcbiAgICAgICAgICByZW1vdmVDbGFzcyhvcHRpb25FbCwgXCJzZWxlY3RlZFwiKTtcclxuICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zID0gdGhpcy5zZWxlY3RlZE9wdGlvbnMuZmlsdGVyKFxyXG4gICAgICAgICAgICAoaXRlbSkgPT4gaXRlbSAhPT0gb3B0aW9uXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgY29uc3Qgb3B0ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAgICAgICBgb3B0aW9uW3ZhbHVlPVwiJHtvcHRpb25FbC5kYXRhc2V0LnZhbHVlfVwiXWBcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICBpZiAob3B0KSB7XHJcbiAgICAgICAgICAgIG9wdC5yZW1vdmVBdHRyaWJ1dGUoXCJzZWxlY3RlZFwiKTtcclxuICAgICAgICAgICAgb3B0LnNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgdGhpcy5fbXVsdGlwbGVMaXN0UmVtb3ZlKG9wdGlvbik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGFkZENsYXNzKG9wdGlvbkVsLCBcInNlbGVjdGVkXCIpO1xyXG4gICAgICAgICAgdGhpcy5zZWxlY3RlZE9wdGlvbnMucHVzaChvcHRpb24pO1xyXG5cclxuICAgICAgICAgIGlmKHRoaXMuY29uZmlnLnNob3dTZWxlY3RlZEl0ZW1zKXtcclxuICAgICAgICAgICAgb3B0aW9uLmF0dHJpYnV0ZXMuc2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9tdWx0aXBsZUxpc3RBZGQob3B0aW9uKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLmZvckVhY2goKGl0ZW0pID0+IHJlbW92ZUNsYXNzKGl0ZW0uZWxlbWVudCwgXCJzZWxlY3RlZFwiKSk7XHJcblxyXG4gICAgICAgIGFkZENsYXNzKG9wdGlvbkVsLCBcInNlbGVjdGVkXCIpO1xyXG5cclxuICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucyA9IFtvcHRpb25dO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLl9yZW5kZXJTZWxlY3RlZEl0ZW1zKCk7XHJcblxyXG4gICAgICB0aGlzLnVwZGF0ZVNlbGVjdFZhbHVlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRWYWx1ZSh2YWx1ZSkge1xyXG4gICAgY29uc3Qgc2VsZWN0ID0gdGhpcy5lbDtcclxuICAgIGxldCBub1NlbGVjdGVkID0gdHJ1ZTtcclxuXHJcbiAgICAvLyBWYWxpZGF0ZSBpbnB1dCB0eXBlXHJcbiAgICBpZiAoc2VsZWN0Lm11bHRpcGxlKSB7XHJcbiAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFZhbHVlIGV4cGVjdHMgYW4gYXJyYXkgZm9yIG11bHRpcGxlIHNlbGVjdCBlbGVtZW50cycpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YWx1ZSA9IHZhbHVlLm1hcChTdHJpbmcpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzZXRWYWx1ZSBleHBlY3RzIGEgc2luZ2xlIHZhbHVlIGZvciBub24tbXVsdGlwbGUgc2VsZWN0IGVsZW1lbnRzJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycgJiYgdHlwZW9mIHZhbHVlICE9PSAnbnVtYmVyJykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc2V0VmFsdWUgZXhwZWN0cyBhIHN0cmluZyBvciBudW1iZXIgZm9yIG5vbi1tdWx0aXBsZSBzZWxlY3QgZWxlbWVudHMnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFsdWUgPSBTdHJpbmcodmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGZvciAoY29uc3Qgb3B0IG9mIHNlbGVjdC5vcHRpb25zKSB7XHJcbiAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IHNlbGVjdC5tdWx0aXBsZVxyXG4gICAgICAgID8gdmFsdWUuaW5jbHVkZXMob3B0LnZhbHVlKVxyXG4gICAgICAgICAgPyBvcHQudmFsdWVcclxuICAgICAgICAgIDogbnVsbFxyXG4gICAgICAgIDogdmFsdWU7XHJcbiAgICAgIGlmIChvcHQudmFsdWUgPT09IGN1cnJlbnRWYWx1ZSAmJiAhb3B0LmRpc2FibGVkKSB7XHJcbiAgICAgICAgaWYgKG5vU2VsZWN0ZWQpIHtcclxuICAgICAgICAgIHNlbGVjdC52YWx1ZSA9IGN1cnJlbnRWYWx1ZTtcclxuICAgICAgICAgIG5vU2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG9wdC5zZXRBdHRyaWJ1dGUoXCJzZWxlY3RlZFwiLCB0cnVlKTtcclxuICAgICAgICBvcHQuc2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIG9wdC5yZW1vdmVBdHRyaWJ1dGUoXCJzZWxlY3RlZFwiKTtcclxuICAgICAgICBvcHQuc2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChub1NlbGVjdGVkICYmICFzZWxlY3QubXVsdGlwbGUgJiYgc2VsZWN0Lm9wdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgIHNlbGVjdC5vcHRpb25zWzBdLnNldEF0dHJpYnV0ZShcInNlbGVjdGVkXCIsIHRydWUpO1xyXG4gICAgICBzZWxlY3Qub3B0aW9uc1swXS5zZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgIHNlbGVjdC52YWx1ZSA9IHNlbGVjdC5vcHRpb25zWzBdLnZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMudXBkYXRlKCk7XHJcbiAgfVxyXG5cclxuICBnZXRWYWx1ZSgpIHtcclxuICAgIGNvbnN0IHNlbGVjdCA9IHRoaXMuZWw7XHJcbiAgICBpZiAoIXNlbGVjdC5tdWx0aXBsZSkgcmV0dXJuIHNlbGVjdC52YWx1ZTtcclxuXHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbShzZWxlY3Qub3B0aW9ucylcclxuICAgICAgLmZpbHRlcigob3B0KSA9PiBvcHQuc2VsZWN0ZWQpXHJcbiAgICAgIC5tYXAoKG9wdCkgPT4gb3B0LnZhbHVlKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVNlbGVjdFZhbHVlKCkge1xyXG4gICAgaWYgKHRoaXMuc2VsZWN0ZWRPcHRpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgdGhpcy5lbC52YWx1ZSA9IHRoaXMuc2VsZWN0ZWRPcHRpb25zWzBdLmRhdGEudmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc2VsZWN0ID0gdGhpcy5lbDtcclxuXHJcbiAgICAvLyBGSXJzdCBtYXJrIGFsbCBvcHRpb25zIGFzIG5vdCBzZWxlY3RlZFxyXG4gICAgc2VsZWN0LnF1ZXJ5U2VsZWN0b3JBbGwoXCJvcHRpb25cIikuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICBpdGVtLnJlbW92ZUF0dHJpYnV0ZShcInNlbGVjdGVkXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gTWFyayB0aGUgc2VsZWN0ZWQgb3B0aW9ucyBhcyBzZWxlY3RlZCBpbiB0aGUgc2VsZWN0IGVsZW1lbnRcclxuICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zLmZvckVhY2goIGl0ZW0gPT4ge1xyXG4gICAgICBsZXQgZWwgPSBzZWxlY3QucXVlcnlTZWxlY3Rvcihgb3B0aW9uW3ZhbHVlPVwiJHtpdGVtLmRhdGEudmFsdWV9XCJdYCk7XHJcblxyXG4gICAgICBpZiAoZWwpe1xyXG4gICAgICAgIC8vQ2hhbmdlIGl0LCBjYXVzZSBpdCB3b3JrcyBtb3JlIGNvcnJlY3RseS5cclxuICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoXCJzZWxlY3RlZFwiLCBcInNlbGVjdGVkXCIpO1xyXG4gICAgICAgIGVsLnNlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdHJpZ2dlckNoYW5nZSh0aGlzLmVsKTtcclxuICB9XHJcblxyXG4gIHJlc2V0U2VsZWN0VmFsdWUoKSB7XHJcbiAgICBpZiAodGhpcy5tdWx0aXBsZSkge1xyXG4gICAgICBjb25zdCBzZWxlY3QgPSB0aGlzLmVsO1xyXG4gICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZWwgPSBzZWxlY3QucXVlcnlTZWxlY3Rvcihgb3B0aW9uW3ZhbHVlPVwiJHtpdGVtLmRhdGEudmFsdWV9XCJdYCk7XHJcbiAgICAgICAgaWYgKGVsKSB7XHJcbiAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoXCJzZWxlY3RlZFwiKTtcclxuICAgICAgICAgIGVsLnNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZE9wdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICB0aGlzLmVsLnNlbGVjdGVkSW5kZXggPSAtMTtcclxuICAgIH1cclxuXHJcbiAgICB0cmlnZ2VyQ2hhbmdlKHRoaXMuZWwpO1xyXG4gIH1cclxuXHJcbiAgX29uQ2xpY2tlZE91dHNpZGUoZSkge1xyXG4gICAgaWYgKCF0aGlzLmRyb3Bkb3duLmNvbnRhaW5zKGUudGFyZ2V0KSkge1xyXG4gICAgICByZW1vdmVDbGFzcyh0aGlzLmRyb3Bkb3duLCBcIm9wZW5cIik7XHJcbiAgICAgIHRyaWdnZXJNb2RhbENsb3NlKHRoaXMuZWwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX29uS2V5UHJlc3NlZChlKSB7XHJcbiAgICBjb25zdCBmb2N1c2VkT3B0aW9uID0gdGhpcy5kcm9wZG93bi5xdWVyeVNlbGVjdG9yKFwiLmZvY3VzXCIpO1xyXG4gICAgY29uc3QgaXNPcGVuID0gaGFzQ2xhc3ModGhpcy5kcm9wZG93biwgXCJvcGVuXCIpO1xyXG5cclxuICAgIGlmIChlLmtleUNvZGUgPT09IDEzKSB7XHJcbiAgICAgIGlzT3BlbiA/IHRyaWdnZXJDbGljayhmb2N1c2VkT3B0aW9uKSA6IHRyaWdnZXJDbGljayh0aGlzLmRyb3Bkb3duKTtcclxuICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09PSA0MCkge1xyXG4gICAgICBpZiAoIWlzT3Blbikge1xyXG4gICAgICAgIHRyaWdnZXJDbGljayh0aGlzLmRyb3Bkb3duKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zdCBuZXh0ID0gdGhpcy5fZmluZE5leHQoZm9jdXNlZE9wdGlvbik7XHJcbiAgICAgICAgaWYgKG5leHQpIHtcclxuICAgICAgICAgIGlmIChmb2N1c2VkT3B0aW9uKSByZW1vdmVDbGFzcyhmb2N1c2VkT3B0aW9uLCBcImZvY3VzXCIpO1xyXG4gICAgICAgICAgYWRkQ2xhc3MobmV4dCwgXCJmb2N1c1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT09IDM4KSB7XHJcbiAgICAgIGlmICghaXNPcGVuKSB7XHJcbiAgICAgICAgdHJpZ2dlckNsaWNrKHRoaXMuZHJvcGRvd24pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IHByZXYgPSB0aGlzLl9maW5kUHJldihmb2N1c2VkT3B0aW9uKTtcclxuICAgICAgICBpZiAocHJldikge1xyXG4gICAgICAgICAgaWYgKGZvY3VzZWRPcHRpb24pIHJlbW92ZUNsYXNzKGZvY3VzZWRPcHRpb24sIFwiZm9jdXNcIik7XHJcbiAgICAgICAgICBhZGRDbGFzcyhwcmV2LCBcImZvY3VzXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gMjcgJiYgaXNPcGVuKSB7XHJcbiAgICAgIHRyaWdnZXJDbGljayh0aGlzLmRyb3Bkb3duKTtcclxuICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09PSAzMiAmJiBpc09wZW4pIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIF9maW5kTmV4dChlbCkge1xyXG4gICAgbGV0IG5leHRFbCA9IGVsXHJcbiAgICAgID8gZWwubmV4dEVsZW1lbnRTaWJsaW5nXHJcbiAgICAgIDogdGhpcy5kcm9wZG93bi5xdWVyeVNlbGVjdG9yKFwiLmxpc3QgLm9wdGlvblwiKTtcclxuICAgIHdoaWxlIChuZXh0RWwpIHtcclxuICAgICAgaWYgKCFoYXNDbGFzcyhuZXh0RWwsIFwiZGlzYWJsZWRcIikgJiYgbmV4dEVsLnN0eWxlLmRpc3BsYXkgIT09IFwibm9uZVwiKVxyXG4gICAgICAgIHJldHVybiBuZXh0RWw7XHJcbiAgICAgIG5leHRFbCA9IG5leHRFbC5uZXh0RWxlbWVudFNpYmxpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBfZmluZFByZXYoZWwpIHtcclxuICAgIGxldCBwcmV2RWwgPSBlbFxyXG4gICAgICA/IGVsLnByZXZpb3VzRWxlbWVudFNpYmxpbmdcclxuICAgICAgOiB0aGlzLmRyb3Bkb3duLnF1ZXJ5U2VsZWN0b3IoXCIubGlzdCAub3B0aW9uOmxhc3QtY2hpbGRcIik7XHJcbiAgICB3aGlsZSAocHJldkVsKSB7XHJcbiAgICAgIGlmICghaGFzQ2xhc3MocHJldkVsLCBcImRpc2FibGVkXCIpICYmIHByZXZFbC5zdHlsZS5kaXNwbGF5ICE9PSBcIm5vbmVcIilcclxuICAgICAgICByZXR1cm4gcHJldkVsO1xyXG4gICAgICBwcmV2RWwgPSBwcmV2RWwucHJldmlvdXNFbGVtZW50U2libGluZztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIF9vblNlYXJjaENoYW5nZWQoZSkge1xyXG4gICAgY29uc3QgdGV4dCA9IGUudGFyZ2V0LnZhbHVlLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgaWYgKHRleHQgPT09IFwiXCIpIHtcclxuICAgICAgdGhpcy5vcHRpb25zLmZvckVhY2goKGl0ZW0pID0+IChpdGVtLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IFwiXCIpKTtcclxuICAgIH0gZWxzZSBpZiAoaGFzQ2xhc3ModGhpcy5kcm9wZG93biwgXCJvcGVuXCIpKSB7XHJcbiAgICAgIGNvbnN0IG1hdGNoUmVnID0gbmV3IFJlZ0V4cCh0ZXh0KTtcclxuICAgICAgdGhpcy5vcHRpb25zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICBpdGVtLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IG1hdGNoUmVnLnRlc3QoaXRlbS5kYXRhLnRleHQudG9Mb3dlckNhc2UoKSlcclxuICAgICAgICAgID8gXCJcIlxyXG4gICAgICAgICAgOiBcIm5vbmVcIjtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5kcm9wZG93blxyXG4gICAgICAucXVlcnlTZWxlY3RvckFsbChcIi5mb2N1c1wiKVxyXG4gICAgICAuZm9yRWFjaCgoaXRlbSkgPT4gcmVtb3ZlQ2xhc3MoaXRlbSwgXCJmb2N1c1wiKSk7XHJcblxyXG4gICAgY29uc3QgZmlyc3RFbCA9IHRoaXMuX2ZpbmROZXh0KG51bGwpO1xyXG5cclxuICAgIGlmIChmaXJzdEVsKSBhZGRDbGFzcyhmaXJzdEVsLCBcImZvY3VzXCIpO1xyXG4gIH1cclxuXHJcbiAgX3RyaWdnZXJWYWxpZGF0aW9uTWVzc2FnZSh0eXBlKSB7XHJcbiAgICBpZiAodHlwZSA9PT0gXCJpbnZhbGlkXCIpIHtcclxuICAgICAgYWRkQ2xhc3ModGhpcy5kcm9wZG93biwgXCJpbnZhbGlkXCIpO1xyXG4gICAgICByZW1vdmVDbGFzcyh0aGlzLmRyb3Bkb3duLCBcInZhbGlkXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYWRkQ2xhc3ModGhpcy5kcm9wZG93biwgXCJ2YWxpZFwiKTtcclxuICAgICAgcmVtb3ZlQ2xhc3ModGhpcy5kcm9wZG93biwgXCJpbnZhbGlkXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX211bHRpcGxlTGlzdEFkZChvcHRpb24pIHtcclxuICBcclxuICAgIGlmKG9wdGlvbi5kYXRhLmRpc2FibGVkIHx8IG9wdGlvbi5kYXRhLnZhbHVlID09IFwiXCIgfHwgIW9wdGlvbi5hdHRyaWJ1dGVzLnNlbGVjdGVkKXtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGlmKHRoaXMuc2VsZWN0aW9uTGlzdCA9PSBudWxsKXtcclxuICAgICAgdGhpcy5zZWxlY3Rpb25MaXN0XHQgXHRcdD0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcclxuICAgICAgdGhpcy5zZWxlY3Rpb25MaXN0LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdC1zZWxlY3Rpb24tbGlzdCcpO1xyXG5cclxuICAgICAgdGhpcy5lbC5hZnRlcih0aGlzLnNlbGVjdGlvbkxpc3QpO1xyXG4gICAgfWVsc2UgaWYodGhpcy5zZWxlY3Rpb25MaXN0LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXZhbHVlPVwiJHtvcHRpb24uZGF0YS52YWx1ZX1cIl1gKSAhPSBudWxsKXtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBsaVx0IFx0XHQ9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICBsaS5jbGFzc0xpc3QuYWRkKCdzZWxlY3Qtc2VsZWN0aW9uJyk7XHJcblxyXG4gICAgbGkuZGF0YXNldC52YWx1ZSA9IG9wdGlvbi5kYXRhLnZhbHVlO1xyXG5cclxuICAgIGxldCBodG1sXHQgID0gYFxyXG4gICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cInNtYWxsIHJlbW92ZS1zZWxlY3Qtc2VsZWN0aW9uXCI+XHJcbiAgICAgICAgPHNwYW4gY2xhc3M9J3JlbW92ZS1zZWxlY3Qtc2VsZWN0aW9uJz7Dlzwvc3Bhbj5cclxuICAgICAgPC9idXR0b24+XHJcbiAgICBgO1xyXG5cclxuICAgIC8vIEFkZFxyXG4gICAgaHRtbCAgICs9IGA8c3BhbiBjbGFzcz0nc2VsZWN0ZWQtbmFtZSc+JHtvcHRpb24uZGF0YS50ZXh0fTwvc3Bhbj5gXHJcblxyXG4gICAgbGkuaW5uZXJIVE1MXHQ9IGh0bWw7XHJcblxyXG4gICAgdGhpcy5zZWxlY3Rpb25MaXN0LmFwcGVuZENoaWxkKGxpKTtcclxuXHJcbiAgICBsaS5xdWVyeVNlbGVjdG9yQWxsKCcucmVtb3ZlLXNlbGVjdC1zZWxlY3Rpb24nKS5mb3JFYWNoKGVsPT4gZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX211bHRpcGxlTGlzdFJlbW92ZS5iaW5kKHRoaXMpKSk7XHJcbiAgfVxyXG5cclxuICBfbXVsdGlwbGVMaXN0UmVtb3ZlKHRhcmdldCkge1xyXG5cclxuICAgIGlmKHRhcmdldC50YXJnZXQgIT0gbnVsbCl7XHJcbiAgICAgIHRhcmdldCAgPSB0YXJnZXQudGFyZ2V0O1xyXG4gICAgfVxyXG5cclxuICAgIGlmKHRhcmdldC5kYXRhID09IHVuZGVmaW5lZCl7XHJcbiAgICAgIHRhcmdldC5jbG9zZXN0KCdsaS5zZWxlY3Qtc2VsZWN0aW9uJykucmVtb3ZlKCk7XHJcblxyXG4gICAgICBsZXQgcGFyZW50ICA9IHRhcmdldC5jbG9zZXN0KCdsaS5zZWxlY3Qtc2VsZWN0aW9uJyk7XHJcblxyXG4gICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiB7XHJcbiAgICAgICAgaWYob3B0aW9uLmRhdGEudmFsdWUgPT0gcGFyZW50LmRhdGFzZXQudmFsdWUpe1xyXG4gICAgICAgICAgcmVtb3ZlQ2xhc3Mob3B0aW9uLmVsZW1lbnQsIFwic2VsZWN0ZWRcIik7XHJcbiAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucy5zcGxpY2UodGhpcy5zZWxlY3RlZE9wdGlvbnMuaW5kZXhPZihvcHRpb24pLCAxKTtcclxuICAgICAgICAgIHZhciBvcHQgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoYG9wdGlvblt2YWx1ZT1cIiR7b3B0aW9uLmRhdGEudmFsdWV9XCJdYCk7XHJcbiAgICAgICAgICBvcHQucmVtb3ZlQXR0cmlidXRlKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgb3B0LnNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9yZW5kZXJTZWxlY3RlZEl0ZW1zKCk7XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgaWYodGFyZ2V0LmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKXtcclxuICAgICAgY29uc29sZS5sb2codGFyZ2V0KTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBwYXJlbnQgID0gdGhpcy5lbC5wYXJlbnRFbGVtZW50O1xyXG4gICAgXHJcbiAgICBsZXQgdWwgICAgICA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCcuc2VsZWN0LXNlbGVjdGlvbi1saXN0Jyk7XHJcbiAgICBcclxuICAgIHRhcmdldCAgPSB1bC5xdWVyeVNlbGVjdG9yKGBbZGF0YS12YWx1ZT1cIiR7dGFyZ2V0LmRhdGEudmFsdWV9XCJdYCk7XHJcblxyXG4gICAgaWYodWwgIT0gbnVsbCAmJiB0YXJnZXQgIT0gbnVsbCl7XHJcbiAgICAgIHRhcmdldC5yZW1vdmUoKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBOaWNlU2VsZWN0O1xyXG5leHBvcnQgZnVuY3Rpb24gYmluZChlbCwgb3B0aW9ucykge1xyXG4gIHJldHVybiBuZXcgTmljZVNlbGVjdChlbCwgb3B0aW9ucyk7XHJcbn0iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///462\n\n}')}},__webpack_require__={d:(l,c)=>{for(var t in c)__webpack_require__.o(c,t)&&!__webpack_require__.o(l,t)&&Object.defineProperty(l,t,{enumerable:!0,get:c[t]})},o:(l,c)=>Object.prototype.hasOwnProperty.call(l,c),r:l=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})}},__webpack_exports__={};return __webpack_modules__[462](0,__webpack_exports__,__webpack_require__),__webpack_exports__})());